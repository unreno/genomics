



20190214 

Align to full hg38

nohup bowtie2 --rg-id 1 --rg SM:GM_983899 --rg LB:unknownLB --rg PL:unknownPL --rg PU:unknownPU -x hg38 -1 GM_983899.1.fastq.gz -2 GM_983899.2.fastq.gz --very-sensitive --threads 20 | samtools view -o GM_983899.name.hg38.bam - > GM_983899.bowtie2.out 2> GM_983899.bowtie2.err &
nohup bowtie2 --rg-id 1 --rg SM:983899 --rg LB:unknownLB --rg PL:unknownPL --rg PU:unknownPU -x hg38 -1 983899.1.fastq.gz -2 983899.2.fastq.gz --very-sensitive --threads 20 | samtools view -o 983899.name.hg38.bam - > 983899.bowtie2.out 2> 983899.bowtie2.err &

This has quietly failed twice now!!!
Perhaps both power outage related.
I don't know what this means, but the timestamp on both bams are 00:49.
Feb 16 00:49:55 system76-server systemd[1]: Stopping User Manager for UID 1001...
Feb 16 00:49:55 system76-server systemd[18719]: Reached target Shutdown.
Feb 16 00:49:55 system76-server systemd[18719]: Starting Exit the Session...
Feb 16 00:49:55 system76-server systemd[18719]: Stopped target Default.
Feb 16 00:49:55 system76-server systemd[18719]: Stopped target Basic System.
Feb 16 00:49:55 system76-server systemd[18719]: Stopped target Timers.
Feb 16 00:49:55 system76-server systemd[18719]: Stopped target Sockets.
Feb 16 00:49:55 system76-server systemd[18719]: Stopped target Paths.
Feb 16 00:49:55 system76-server systemd[18719]: Received SIGRTMIN+24 from PID 24644 (kill).
Feb 16 00:49:55 system76-server systemd[1]: Stopped User Manager for UID 1001.
Feb 16 00:49:55 system76-server systemd[1]: Removed slice User Slice of jake.




Sample.Reference.Alignment.Caller.vcf.gz


nohup ./process.bash &

update_blastdb.pl --decompress nt
update_blastdb.pl --decompress refseq_genomic

other_genomic.*tar.gz         | RefSeq chromosome records (NC_######) for non-human organisms

refseq_genomic.*tar.gz        | NCBI genomic reference sequences

nt.*tar.gz                    | Partially non-redundant nucleotide sequences from 
                                all traditional divisions of GenBank, EMBL, and DDBJ 
                                excluding GSS,STS, PAT, EST, HTG, and WGS.





blastn -db viral -query <( zcat 983899.1.fastq.gz | sed -n '1~4s/^@/>/p;2~4p' ) | more

for f in *.fastq.gz ; do
b=$( basename $f .fastq.gz )
echo $f $b
blastn -num_threads 10 -outfmt 6 -db viral -query <( zcat $f | sed -n '1~4s/^@/>/p;2~4p' ) -out $b.viral.txt &
done

Want a better viral database. Found out that you can filter with gilist.

blastn -num_threads 40 -outfmt 6 -db nt -gilist /raid/refs/blast/Viruses.gilist -query <( zcat 983899.1.fastq.gz | sed -n '1~4s/^@/>/p;2~4p' ) | more



for f in *.fastq.gz ; do
b=$( basename $f .fastq.gz )
echo $f $b
blastn -num_threads 10 -outfmt 6 -db nt -gilist /raid/refs/blast/Viruses.gilist -query <( zcat $f | sed -n '1~4s/^@/>/p;2~4p' ) -out $b.Viruses.10.txt &
done

for f in *.fastq.gz ; do
b=$( basename $f .fastq.gz )
echo $f $b
blastn -num_threads 40 -outfmt 6 -db nt -gilist /raid/refs/blast/Viruses.gilist -query <( zcat $f | sed -n '1~4s/^@/>/p;2~4p' ) -out $b.Viruses.40.txt &
done

for f in *.fastq.gz ; do
b=$( basename $f .fastq.gz )
echo $f $b
blastn -num_threads 80 -outfmt 6 -db nt -gilist /raid/refs/blast/Viruses.gilist -query <( zcat $f | sed -n '1~4s/^@/>/p;2~4p' ) -out $b.Viruses.80.txt 2> $b.Viruses.80.err &
done


10x more alignments in smaller viral database than the Viruses subset of nt???
No. blastn kept crashing?




for f in *.fastq.gz ; do
b=$( basename $f .fastq.gz )
echo $f $b
nohup blastn -num_threads 80 -outfmt 6 -db nt -gilist /raid/refs/blast/Viruses.gilist -query <( zcat $f | sed -n '1~4s/^@/>/p;2~4p' ) -out $b.Viruses.txt 2> $b.Viruses.err &
done


for f in *.fastq.gz ; do
b=$( basename $f .fastq.gz )
echo $f $b
blastn -num_threads 80 -outfmt 6 -db viral.genomic -query <( zcat $f | sed -n '1~4s/^@/>/p;2~4p' ) -out $b.viral.genomic.txt 2> $b.viral.genomic.err &
done



Sometimes, I get this and then all blastns quit?????
Warning: [blastn] lcl|Query_2590 E00368R:279:HJHMJCCXY:2:1101:10084:2: Warning: Sequence contains no data 

Can't find thie sequence in either??

nohup fastqToFa <( zcat 983899.1.fastq.gz ) 983899.1.fa &
nohup fastqToFa <( zcat 983899.2.fastq.gz ) 983899.2.fa &
nohup fastqToFa <( zcat GM_983899.1.fastq.gz ) GM_983899.1.fa &
nohup fastqToFa <( zcat GM_983899.2.fastq.gz ) GM_983899.2.fa &
wc -l *fa
  1364473172 983899.1.fa
  1364473172 983899.2.fa
   789764678 GM_983899.1.fa
   789764678 GM_983899.2.fa



for f in *.fa ; do
b=$( basename $f .fa )
echo $f $b
nohup blastn -num_threads 80 -outfmt 6 -db nt -gilist /raid/refs/blast/Viruses.gilist -query $f -out $b.Viruses.txt 2> $b.Viruses.err &
nohup blastn -num_threads 80 -outfmt 6 -db viral.genomic -query $f -out $b.viral.genomic.txt 2> $b.viral.genomic.err &
nohup blastn -num_threads 80 -outfmt 6 -db viral -query $f -out $b.viral.txt 2> $b.viral.err &
done




