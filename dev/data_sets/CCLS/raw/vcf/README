



--------
20180718

for f in *output-HC.vcf ; do echo $f; bgzip $f & done
for f in *output-HC.vcf.gz ; do echo $f; gatk IndexFeatureFile -F $f & bcftools index $f & done


for f in /raid/data/raw/20170804-Adam/VCF/*.output-hc.vcf.gz ; do echo $f ; ln -s $f ; done


--------

20170804


bcftools filter -i 'TYPE="snp"' $f > $b.snp.vcf &
bcftools filter -i 'TYPE="snp" && DB=0' $f > $b.snp.DB0.vcf &
bcftools filter -i 'TYPE="snp" && DB=0 && QD>=2.0' $f > $b.snp.DB0.QD2.vcf &
bcftools filter -i 'TYPE="snp" && DB=0 && QD>=3.0' $f > $b.snp.DB0.QD3.vcf &
bcftools filter -i 'TYPE="snp" && DB=0 && QD>=4.0' $f > $b.snp.DB0.QD4.vcf &
bcftools filter -i 'TYPE="snp" && DB=0 && QD>=5.0' $f > $b.snp.DB0.QD5.vcf &
bcftools filter -i 'TYPE="snp" && DB=0 && QD>=30.0' $f > $b.snp.DB0.QD30.vcf &
bcftools filter -i 'TYPE="snp" && DB=0 && QD>=2.0 && FMT/DP>30' $f > $b.snp.DB0.QD2.DP30.vcf &
bcftools filter -i 'TYPE="snp" && DB=0 && QD>=2.0 && FMT/DP>=10 && FMT/GQ>=15' $f > $b.snp.DB0.QD2.DP10.GQ15.vcf &



bcftools filter -i 'TYPE="snp" && QUAL>=100 && FMT/DP>100 && DB=1' 186069.output-hc.vcf > 186069.output-hc.snp.qual100.dp100.db1.vcf &




for vcf in $( ls /raid/data/raw/20170804-Adam/VCF/*.output-hc.snp.vcf ) ; do
  b=$( basename $vcf )
  b=${b%.output-hc.vcf}
  echo $b
  cat $vcf | awk 'BEGIN{FS=OFS="\t"}( !/^#/ ){ print $1,$2,$4,$5 }' > ${b}.snps.txt
  chmod 444 ${b}.snps.txt
done


for f in *output-hc.vcf ; do
echo $f
bgzip $f &
done

for f in *output-hc.vcf ; do echo $f; bgzip $f & done
for f in *output-hc.vcf.gz ; do echo $f; gatk IndexFeatureFile -F $f & bcftools index $f & done









Depth Analysis

zcat 983899.output-HC.vcf.gz | grep -o -E 'DP=[[:digit:]]+' | awk -F= '{print $2}'





ll *983899*{loc,e2e}*vcf.gz
\rm *983899*{loc,e2e}*vcf.gz

ln -s 983899.output-HC.vcf.gz    983899.hg38_num_noalts.loc.sentieon.vcf.gz
ln -s GM_983899.output-HC.vcf.gz GM_983899.hg38_num_noalts.loc.sentieon.vcf.gz
ln -s ../bam/983899.recaled.PP.bcftools-c.vcf.gz    983899.hg38_num_noalts.loc_PP.bcftools-c.vcf.gz
ln -s ../bam/983899.recaled.PP.bcftools-m.vcf.gz    983899.hg38_num_noalts.loc_PP.bcftools-m.vcf.gz
ln -s ../bam/983899.recaled.PP.vcf.gz               983899.hg38_num_noalts.loc_PP.gatk.vcf.gz
ln -s ../bam/983899.recaled.bcftools-c.vcf.gz       983899.hg38_num_noalts.loc.bcftools-c.vcf.gz
ln -s ../bam/983899.recaled.bcftools-m.vcf.gz       983899.hg38_num_noalts.loc.bcftools-m.vcf.gz
ln -s ../bam/983899.recaled.vcf.gz                  983899.hg38_num_noalts.loc.gatk.vcf.gz
ln -s ../bam/GM_983899.recaled.PP.bcftools-c.vcf.gz GM_983899.hg38_num_noalts.loc_PP.bcftools-c.vcf.gz
ln -s ../bam/GM_983899.recaled.PP.bcftools-m.vcf.gz GM_983899.hg38_num_noalts.loc_PP.bcftools-m.vcf.gz
ln -s ../bam/GM_983899.recaled.PP.vcf.gz            GM_983899.hg38_num_noalts.loc_PP.gatk.vcf.gz
ln -s ../bam/GM_983899.recaled.bcftools-c.vcf.gz    GM_983899.hg38_num_noalts.loc.bcftools-c.vcf.gz
ln -s ../bam/GM_983899.recaled.bcftools-m.vcf.gz    GM_983899.hg38_num_noalts.loc.bcftools-m.vcf.gz
ln -s ../bam/GM_983899.recaled.vcf.gz               GM_983899.hg38_num_noalts.loc.gatk.vcf.gz

ln -s ../../CCLS_983899/983899.hg38_num_noalts.e2e_PP.bcftools-c.vcf.gz    983899.hg38_num_noalts.e2e_PP.bcftools-c.vcf.gz
ln -s ../../CCLS_983899/983899.hg38_num_noalts.e2e_PP.bcftools-m.vcf.gz    983899.hg38_num_noalts.e2e_PP.bcftools-m.vcf.gz
ln -s ../../CCLS_983899/983899.hg38_num_noalts.e2e_PP.vcf.gz               983899.hg38_num_noalts.e2e_PP.gatk.vcf.gz
ln -s ../../CCLS_983899/983899.hg38_num_noalts.e2e.bcftools-c.vcf.gz       983899.hg38_num_noalts.e2e.bcftools-c.vcf.gz
ln -s ../../CCLS_983899/983899.hg38_num_noalts.e2e.bcftools-m.vcf.gz       983899.hg38_num_noalts.e2e.bcftools-m.vcf.gz
ln -s ../../CCLS_983899/983899.hg38_num_noalts.e2e.vcf.gz                  983899.hg38_num_noalts.e2e.gatk.vcf.gz
ln -s ../../CCLS_983899/GM_983899.hg38_num_noalts.e2e_PP.bcftools-c.vcf.gz GM_983899.hg38_num_noalts.e2e_PP.bcftools-c.vcf.gz
ln -s ../../CCLS_983899/GM_983899.hg38_num_noalts.e2e_PP.bcftools-m.vcf.gz GM_983899.hg38_num_noalts.e2e_PP.bcftools-m.vcf.gz
ln -s ../../CCLS_983899/GM_983899.hg38_num_noalts.e2e_PP.vcf.gz            GM_983899.hg38_num_noalts.e2e_PP.gatk.vcf.gz
ln -s ../../CCLS_983899/GM_983899.hg38_num_noalts.e2e.bcftools-c.vcf.gz    GM_983899.hg38_num_noalts.e2e.bcftools-c.vcf.gz
ln -s ../../CCLS_983899/GM_983899.hg38_num_noalts.e2e.bcftools-m.vcf.gz    GM_983899.hg38_num_noalts.e2e.bcftools-m.vcf.gz
ln -s ../../CCLS_983899/GM_983899.hg38_num_noalts.e2e.vcf.gz               GM_983899.hg38_num_noalts.e2e.gatk.vcf.gz

ln -s ../../CCLS_983899/983899.hg38_chr_alts.e2e_PP.gatk.vcf.gz    983899.hg38_chr_alts.e2e_PP.gatk.vcf.gz
ln -s ../../CCLS_983899/983899.hg38_chr_alts.gatk.vcf.gz           983899.hg38_chr_alts.e2e.gatk.vcf.gz
ln -s ../../CCLS_983899/GM_983899.hg38_chr_alts.e2e_PP.gatk.vcf.gz GM_983899.hg38_chr_alts.e2e_PP.gatk.vcf.gz
ln -s ../../CCLS_983899/GM_983899.hg38_chr_alts.gatk.vcf.gz        GM_983899.hg38_chr_alts.e2e.gatk.vcf.gz

ln -s ../../CCLS_983899/983899.hg38_chr_alts.e2e_PP.bcftools-c.vcf.gz    983899.hg38_chr_alts.e2e_PP.bcftools-c.vcf.gz
ln -s ../../CCLS_983899/983899.hg38_chr_alts.bcftools-c.vcf.gz           983899.hg38_chr_alts.e2e.bcftools-c.vcf.gz
ln -s ../../CCLS_983899/GM_983899.hg38_chr_alts.e2e_PP.bcftools-c.vcf.gz GM_983899.hg38_chr_alts.e2e_PP.bcftools-c.vcf.gz
ln -s ../../CCLS_983899/GM_983899.hg38_chr_alts.bcftools-c.vcf.gz        GM_983899.hg38_chr_alts.e2e.bcftools-c.vcf.gz

ln -s ../../CCLS_983899/983899.hg38_chr_alts.e2e_PP.bcftools-m.vcf.gz    983899.hg38_chr_alts.e2e_PP.bcftools-m.vcf.gz
ln -s ../../CCLS_983899/983899.hg38_chr_alts.bcftools-m.vcf.gz           983899.hg38_chr_alts.e2e.bcftools-m.vcf.gz
ln -s ../../CCLS_983899/GM_983899.hg38_chr_alts.e2e_PP.bcftools-m.vcf.gz GM_983899.hg38_chr_alts.e2e_PP.bcftools-m.vcf.gz
ln -s ../../CCLS_983899/GM_983899.hg38_chr_alts.bcftools-m.vcf.gz        GM_983899.hg38_chr_alts.e2e.bcftools-m.vcf.gz

ll *983899*{loc,e2e}*vcf.gz



