

What to do with multiple ALT calls? Split call? Threshold? Drop?

Filter on Biases?

How to keep strand in VCF?





for sample in 983899 268325 439338 63185 634370 120207 122997 186069 201771 209605 266836 321666 341203 36077 492023 495910 506458 530196 607654 673944 73753 780690 811386 813891 833536 853767 866648 868614 871719 900420 919207 972727 99776 ; do
for chr in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 X ; do
echo ./create_somatic_vcfs.bash $sample $chr \>\> ${sample}.${chr}.create_somatic_vcfs.log 2\>\&1
done ; done | parallel -j 40 --no-notice --joblog parallel.log &



Even after a number of mods, count_trinuc_muts_v8.pl still takes memory into swap
something in the perl script is eating lots of memory for no reason. probably the db fasta


for sample in 983899 268325 439338 63185 634370 120207 122997 186069 201771 209605 266836 321666 341203 36077 492023 495910 506458 530196 607654 673944 73753 780690 811386 813891 833536 853767 866648 868614 871719 900420 919207 972727 99776 ; do
echo ./aggregate_somatic_vcfs.bash $sample \>\> ${sample}.aggregate_somatic_vcfs.log 2\>\&1
done | parallel -j 40 --no-notice --joblog parallel.aggregate.log &





for sample in 983899 268325 439338 63185 634370 ; do
zcat ${sample}.somatic/${sample}.strelka.filtered.allele_ratios.csv.gz | tail -n +2 | awk -F"\t" '{ if( $3 == 0 )print 0; else print 1}' | sort | uniq -c
done

for sample in 983899 268325 439338 63185 634370 ; do
zcat ${sample}.somatic/${sample}.strelka.filtered.allele_ratios.csv.gz | tail -n +2 | awk -F"\t" '{ if( $5 == 0 && $6 == 0 )print 0; else print 1}' | sort | uniq -c
done

for sample in 983899 268325 439338 63185 634370 ; do
zcat ${sample}.somatic/${sample}.strelka.filtered.allele_ratios.csv.gz | tail -n +2 | awk -F"\t" '{ if( $3 < 0.5 )print 0; else print 1}' | sort | uniq -c
done











\rm -f mut_all_sort.tmp
zcat 983899.somatic/983899.strelka.filtered.count_trinuc_muts.txt.gz | head -1 > mut_all_sort.txt
for sample in 983899 268325 439338 63185 634370 ; do
zcat ${sample}.somatic/${sample}.strelka.filtered.count_trinuc_muts.txt.gz | tail -n +2 >> mut_all_sort.tmp
done
sort -k1,1 -k2,2n mut_all_sort.tmp >> mut_all_sort.txt
\rm mut_all_sort.tmp
cp mut_all_sort.txt mut_all_sort-strelka.txt

./Mutation-Signatures.r
mv mutations.pdf mutations-strelka.pdf



\rm -f mut_all_sort.tmp
zcat 983899.somatic/983899.mutect.filtered.snps.count_trinuc_muts.txt.gz | head -1 > mut_all_sort.txt
for sample in 983899 268325 439338 63185 634370 ; do
zcat ${sample}.somatic/${sample}.mutect.filtered.snps.count_trinuc_muts.txt.gz | tail -n +2 >> mut_all_sort.tmp
done
sort -k1,1 -k2,2n mut_all_sort.tmp >> mut_all_sort.txt
\rm mut_all_sort.tmp
cp mut_all_sort.txt mut_all_sort-mutect.txt

./Mutation-Signatures.r
mv mutations.pdf mutations-mutect.pdf



\rm -f mut_all_sort.tmp
zcat 983899.somatic/983899.recaled.mpileup*.0.30.count_trinuc_muts.txt.gz | head -1 > mut_all_sort.txt
for sample in GM_983899 GM_268325 GM_439338 GM_63185 GM_634370 983899 268325 439338 63185 634370 120207 122997 186069 201771 209605 266836 321666 341203 36077 492023 495910 506458 530196 607654 673944 73753 780690 811386 813891 833536 853767 866648 868614 871719 900420 919207 972727 99776 ; do
zcat *.somatic/${sample}.recaled.mpileup*0.30.count_trinuc_muts.txt.gz | tail -n +2 >> mut_all_sort.tmp
done
sort -k1,1 -k2,2n mut_all_sort.tmp >> mut_all_sort.txt
\rm mut_all_sort.tmp
cp mut_all_sort.txt mut_all_sort-manual-0.30.txt

./Mutation-Signatures.r
mv mutations.pdf mutations-manual-0.30.pdf




\rm -f mut_all_sort.tmp
zcat 983899.somatic/983899.recaled.mpileup*.0.20.count_trinuc_muts.txt.gz | head -1 > mut_all_sort.txt
for sample in GM_983899 GM_268325 GM_439338 GM_63185 GM_634370 983899 268325 439338 63185 634370 120207 122997 186069 201771 209605 266836 321666 341203 36077 492023 495910 506458 530196 607654 673944 73753 780690 811386 813891 833536 853767 866648 868614 871719 900420 919207 972727 99776 ; do
zcat *.somatic/${sample}.recaled.mpileup*0.20.count_trinuc_muts.txt.gz | tail -n +2 >> mut_all_sort.tmp
done
sort -k1,1 -k2,2n mut_all_sort.tmp >> mut_all_sort.txt
\rm mut_all_sort.tmp
cp mut_all_sort.txt mut_all_sort-manual-0.20.txt

./Mutation-Signatures.r
mv mutations.pdf mutations-manual-0.20.pdf




mkdir mutations-manual-0.20
cd mutations-manual-0.20
pdftk ../mutations-manual-0.20.pdf burst
for pdf in *pdf ; do
png=$( basename $pdf .pdf )
gs -sDEVICE=png16m -dTextAlphaBits=4 -r300 -o ${png}.png ${pdf}
done




for sample in 983899 268325 439338 63185 634370 ; do
zcat ${sample}.somatic/${sample}.mutect.filtered.snps.allele_ratios.csv.gz | tail -n +2 | awk -F"\t" '{ if( $5 == 0 && $6 == 0 ) print 0; else print 1}' | sort | uniq -c
done



\rm -f mut_all_sort.tmp
zcat 983899.somatic/983899.recaled.mpileup*.GNOMAD_AF.Bias.count_trinuc_muts.txt.gz | head -1 > mut_all_sort.txt
for sample in GM_983899 GM_268325 GM_439338 GM_63185 GM_634370 983899 268325 439338 63185 634370 120207 122997 186069 201771 209605 266836 321666 341203 36077 492023 495910 506458 530196 607654 673944 73753 780690 811386 813891 833536 853767 866648 868614 871719 900420 919207 972727 99776 ; do
zcat *.somatic/${sample}.recaled.mpileup*GNOMAD_AF.Bias.count_trinuc_muts.txt.gz | tail -n +2 >> mut_all_sort.tmp
done
sort -k1,1 -k2,2n mut_all_sort.tmp >> mut_all_sort.txt
\rm mut_all_sort.tmp
cp mut_all_sort.txt mut_all_sort-Bias.txt

./Mutation-Signatures.r
mv mutations.pdf mutations-Bias.pdf




